# OpenRecommend å·¥ç¨‹å®Œå–„æ€»ç»“

**å®Œæˆæ—¶é—´**: 2026-02-15  
**é¡¹ç›®ç‰ˆæœ¬**: 1.0.0

---

## ğŸ“‹ å®ç°æ¦‚è¿°

æ ¹æ®å¼€å‘è®¡åˆ’æ–‡æ¡£ï¼Œå·²æˆåŠŸå®Œå–„OpenRecommendå¤šå†…å®¹ç±»å‹æ™ºèƒ½æ¨èç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ã€‚

---

## âœ… æœ¬æ¬¡å®Œæˆçš„åŠŸèƒ½

### 1. æ•°æ®è®¿é—®å±‚ (6ä¸ªMapper) âœ…

#### ArticleMapper.java
- `selectByTags()` - æ ¹æ®æ ‡ç­¾æŸ¥è¯¢æ–‡ç« ï¼ˆæ”¯æŒJSONæ ‡ç­¾æŸ¥è¯¢ï¼‰
- `selectHotArticles()` - æŸ¥è¯¢çƒ­é—¨æ–‡ç« ï¼ˆç»¼åˆæµè§ˆã€ç‚¹èµã€è¯„è®ºã€åˆ†äº«æ•°æ®ï¼‰
- `selectNotInIds()` - æŸ¥è¯¢æœªé˜…è¯»çš„æ–‡ç« ï¼ˆæ’é™¤å·²è¯»å†…å®¹ï¼‰
- `selectByCategory()` - æ ¹æ®åˆ†ç±»æŸ¥è¯¢æ–‡ç« 
- `selectByAuthor()` - æ ¹æ®ä½œè€…æŸ¥è¯¢æ–‡ç« 

#### ImageMapper.java
- `selectHotImages()` - æŸ¥è¯¢çƒ­é—¨å›¾ç‰‡
- `selectByTags()` - æ ¹æ®æ ‡ç­¾æŸ¥è¯¢å›¾ç‰‡
- `selectByCategory()` - æ ¹æ®åˆ†ç±»æŸ¥è¯¢å›¾ç‰‡
- `selectByUploader()` - æ ¹æ®ä¸Šä¼ è€…æŸ¥è¯¢å›¾ç‰‡

#### VideoMapper.java
- `selectHotVideos()` - æŸ¥è¯¢çƒ­é—¨è§†é¢‘
- `selectByTags()` - æ ¹æ®æ ‡ç­¾æŸ¥è¯¢è§†é¢‘
- `selectByCategory()` - æ ¹æ®åˆ†ç±»æŸ¥è¯¢è§†é¢‘
- `selectByUploader()` - æ ¹æ®ä¸Šä¼ è€…æŸ¥è¯¢è§†é¢‘

#### UserBehaviorMapper.java
- `selectRecentBehaviors()` - æŸ¥è¯¢ç”¨æˆ·è¿‘æœŸè¡Œä¸º
- `selectHistoryContentIds()` - æŸ¥è¯¢ç”¨æˆ·å†å²å†…å®¹ID
- `selectByUserAndContent()` - æŸ¥è¯¢ç”¨æˆ·åœ¨æŒ‡å®šå†…å®¹ä¸Šçš„è¡Œä¸º
- `countByBehaviorType()` - ç»Ÿè®¡ç”¨æˆ·è¡Œä¸ºæ¬¡æ•°

#### UserProfileMapper.java
- `selectByUserId()` - æ ¹æ®ç”¨æˆ·IDæŸ¥è¯¢ç”»åƒ
- `selectNeedUpdate()` - æŸ¥è¯¢éœ€è¦æ›´æ–°çš„ç”»åƒåˆ—è¡¨

#### UserMapper.java
- åŸºç¡€CRUDç»§æ‰¿è‡ªBaseMapper

### 2. æ¨èç®—æ³• âœ…

#### SimilarityCalculator.javaï¼ˆç›¸ä¼¼åº¦è®¡ç®—å·¥å…·ç±»ï¼‰

**æ ¸å¿ƒç®—æ³•**ï¼š
- âœ… `cosineSimilarity()` - ä½™å¼¦ç›¸ä¼¼åº¦ï¼ˆå‘é‡å¤¹è§’ä½™å¼¦å€¼ï¼‰
- âœ… `jaccardSimilarity()` - Jaccardç›¸ä¼¼åº¦ï¼ˆé›†åˆäº¤é›†/å¹¶é›†ï¼‰
- âœ… `pearsonCorrelation()` - çš®å°”é€Šç›¸å…³ç³»æ•°ï¼ˆçº¿æ€§ç›¸å…³æ€§ï¼‰
- âœ… `euclideanDistance()` - æ¬§æ°è·ç¦»
- âœ… `distanceToSimilarity()` - è·ç¦»è½¬ç›¸ä¼¼åº¦
- âœ… `normalize()` - å‘é‡å½’ä¸€åŒ–

**åº”ç”¨åœºæ™¯**ï¼š
- æ–‡æœ¬å‘é‡ç›¸ä¼¼åº¦è®¡ç®—
- ç”¨æˆ·å…´è¶£åŒ¹é…
- ç‰©å“ç›¸ä¼¼åº¦è®¡ç®—

#### ContentBasedRecommender.javaï¼ˆåŸºäºå†…å®¹çš„æ¨èç®—æ³•ï¼‰

**æ ¸å¿ƒæ–¹æ³•**ï¼š
- âœ… `recommendByTags()` - åŸºäºæ ‡ç­¾æ¨èå†…å®¹
- âœ… `recommendBySimilarity()` - åŸºäºç›¸ä¼¼å†…å®¹æ¨è
- âœ… `recommendByCategory()` - åŸºäºåˆ†ç±»æ¨è

**æ”¯æŒå†…å®¹ç±»å‹**ï¼š
- æ–‡ç« æ¨èï¼ˆæ ‡ç­¾åŒ¹é… + è´¨é‡åˆ†æ•°ï¼‰
- å›¾ç‰‡æ¨èï¼ˆæ ‡ç­¾åŒ¹é…ï¼‰
- è§†é¢‘æ¨èï¼ˆæ ‡ç­¾åŒ¹é…ï¼‰

**ç®—æ³•ç‰¹ç‚¹**ï¼š
- æ”¯æŒå¤šæ ‡ç­¾åŒ¹é…
- èåˆè´¨é‡åˆ†æ•°å’Œçƒ­åº¦
- è‡ªåŠ¨æ’é™¤å·²æŸ¥çœ‹å†…å®¹

#### CollaborativeFiltering.javaï¼ˆååŒè¿‡æ»¤æ¨èç®—æ³•ï¼‰

**æ ¸å¿ƒæ–¹æ³•**ï¼š
- âœ… `userBasedCF()` - åŸºäºç”¨æˆ·çš„ååŒè¿‡æ»¤ï¼ˆæ‰¾ç›¸ä¼¼ç”¨æˆ·ï¼Œæ¨èä»–ä»¬å–œæ¬¢çš„å†…å®¹ï¼‰
- âœ… `itemBasedCF()` - åŸºäºç‰©å“çš„ååŒè¿‡æ»¤ï¼ˆæ‰¾ç›¸ä¼¼ç‰©å“ï¼Œæ¨èä¸å·²çœ‹ç‰©å“ç›¸ä¼¼çš„å†…å®¹ï¼‰
- âœ… `hybridCF()` - æ··åˆååŒè¿‡æ»¤ï¼ˆUser-based 40% + Item-based 60%ï¼‰

**ç®—æ³•ç‰¹ç‚¹**ï¼š
- åŠ¨æ€è®¡ç®—ç”¨æˆ·ç›¸ä¼¼åº¦
- åŸºäºè¡Œä¸ºæƒé‡ï¼ˆæµè§ˆ=1, ç‚¹èµ=3, æ”¶è—=5, åˆ†äº«=4, è¯„è®º=3ï¼‰
- æ”¯æŒå¤šç»´åº¦æ¨è

### 3. ä¸šåŠ¡æœåŠ¡ âœ…

#### UserProfileService.java & UserProfileServiceImpl.java

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- âœ… `getByUserId()` - è·å–ç”¨æˆ·ç”»åƒï¼ˆæ”¯æŒç¼“å­˜ï¼‰
- âœ… `updateAsync()` - å¼‚æ­¥æ›´æ–°ç”¨æˆ·ç”»åƒ
- âœ… `calculateProfile()` - è®¡ç®—ç”¨æˆ·ç”»åƒ
- âœ… `saveOrUpdate()` - ä¿å­˜æˆ–æ›´æ–°ç”¨æˆ·ç”»åƒ

**ç”»åƒç‰¹å¾è®¡ç®—**ï¼š
- **å…´è¶£æ ‡ç­¾**ï¼šåŸºäºç”¨æˆ·è¡Œä¸ºæå–ï¼Œè®¡ç®—æƒé‡
- **å†…å®¹åå¥½**ï¼šç»Ÿè®¡article/image/videoçš„äº¤äº’å æ¯”
- **æ´»è·ƒæ—¶æ®µ**ï¼šåˆ†æç”¨æˆ·è¡Œä¸ºæ—¶é—´åˆ†å¸ƒ
- **ç»Ÿè®¡æŒ‡æ ‡**ï¼šæ€»æµè§ˆé‡ã€æ€»é˜…è¯»æ—¶é•¿

**è¡Œä¸ºæƒé‡è§„åˆ™**ï¼š
- æµè§ˆï¼šæƒé‡1
- ç‚¹èµï¼šæƒé‡3
- æ”¶è—ï¼šæƒé‡5
- åˆ†äº«ï¼šæƒé‡4
- è¯„è®ºï¼šæƒé‡3

#### CacheService.java & CacheServiceImpl.java

**ç¼“å­˜ç®¡ç†**ï¼š
- âœ… `getUserProfile()` - è·å–ç”¨æˆ·ç”»åƒç¼“å­˜ï¼ˆTTL: 1å°æ—¶ï¼‰
- âœ… `setUserProfile()` - è®¾ç½®ç”¨æˆ·ç”»åƒç¼“å­˜
- âœ… `getRecommend()` - è·å–æ¨èç»“æœç¼“å­˜ï¼ˆTTL: 30åˆ†é’Ÿï¼‰
- âœ… `setRecommend()` - è®¾ç½®æ¨èç»“æœç¼“å­˜
- âœ… `getHotContent()` - è·å–çƒ­é—¨å†…å®¹ç¼“å­˜ï¼ˆTTL: 1å°æ—¶ï¼‰
- âœ… `setContentFeature()` - è®¾ç½®å†…å®¹ç‰¹å¾ç¼“å­˜ï¼ˆTTL: 24å°æ—¶ï¼‰

**ç¼“å­˜ç­–ç•¥**ï¼š
- Cache-Asideæ¨¡å¼ï¼ˆå…ˆæŸ¥ç¼“å­˜ï¼Œæœªå‘½ä¸­æŸ¥DBï¼Œå†å†™å…¥ç¼“å­˜ï¼‰
- è‡ªåŠ¨è¿‡æœŸæœºåˆ¶
- ç¼“å­˜æ¸…ç†æ”¯æŒ

#### RecommendService.java & RecommendServiceImpl.java

**æ¨èæ¥å£**ï¼š
- âœ… `recommend()` - ç»¼åˆæ¨èï¼ˆå¤šç­–ç•¥èåˆï¼‰
- âœ… `recommendByContent()` - åŸºäºå†…å®¹çš„æ¨è
- âœ… `recommendByCollaborativeFiltering()` - ååŒè¿‡æ»¤æ¨è
- âœ… `recommendHot()` - çƒ­é—¨æ¨è
- âœ… `recommendRelated()` - ç›¸å…³æ¨è

**ç»¼åˆæ¨èæµç¨‹**ï¼š
```
1. æ£€æŸ¥ç¼“å­˜ â†’ å‘½ä¸­ç›´æ¥è¿”å›
2. è·å–ç”¨æˆ·ç”»åƒ â†’ å…´è¶£æ ‡ç­¾ã€å†…å®¹åå¥½
3. è·å–å†å²å†…å®¹ â†’ æ’é™¤å·²æŸ¥çœ‹å†…å®¹
4. å¹¶è¡Œæ‰§è¡Œæ¨èç­–ç•¥
   â”œâ”€ åŸºäºå†…å®¹æ¨èï¼ˆæ ‡ç­¾+ç›¸ä¼¼åº¦ï¼‰
   â”œâ”€ ååŒè¿‡æ»¤æ¨èï¼ˆUser-based+Item-basedï¼‰
   â””â”€ çƒ­é—¨æ¨èï¼ˆæµè§ˆ+äº’åŠ¨ï¼‰
5. åˆå¹¶ç»“æœ â†’ å»é‡ã€æ’åº
6. å†™å…¥ç¼“å­˜ â†’ TTL 30åˆ†é’Ÿ
7. è¿”å›æ¨èç»“æœ
```

**å¹¶å‘å¤„ç†**ï¼š
- ä½¿ç”¨è™šæ‹Ÿçº¿ç¨‹æå‡å¹¶å‘æ€§èƒ½
- CompletableFutureå¼‚æ­¥å¹¶è¡Œè°ƒç”¨
- å¤šè·¯å¬å›ç­–ç•¥å¹¶è¡Œæ‰§è¡Œ

---

## ğŸ“Š å®Œæˆåº¦ç»Ÿè®¡

| æ¨¡å— | è®¡åˆ’ä»»åŠ¡ | å·²å®Œæˆ | å®Œæˆç‡ |
|-----|---------|--------|--------|
| Mapperå±‚ | 6ä¸ªæ¥å£ | 6ä¸ª | 100% |
| ç®—æ³•å±‚ | 3ä¸ªç®—æ³•ç±» | 3ä¸ª | 100% |
| æœåŠ¡å±‚ | 3ä¸ªæœåŠ¡ | 3ä¸ª | 100% |
| é…ç½®å±‚ | 4ä¸ªé…ç½®ç±» | 4ä¸ª | 100% |
| å®ä½“å±‚ | 7ä¸ªå®ä½“ç±» | 7ä¸ª | 100% |
| DTOå±‚ | 3ä¸ªDTO | 3ä¸ª | 100% |
| **æ€»è®¡** | **26** | **26** | **100%** |

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½éªŒè¯

### 1. æ¨èå¼•æ“ âœ…

**éªŒè¯è¦ç‚¹**ï¼š
- âœ… æ”¯æŒå¤šç§æ¨èç±»å‹ï¼ˆä¸ªæ€§åŒ–ã€çƒ­é—¨ã€ç›¸å…³ï¼‰
- âœ… æ”¯æŒå¤šç§å†…å®¹ç±»å‹ï¼ˆæ–‡ç« ã€å›¾ç‰‡ã€è§†é¢‘ï¼‰
- âœ… å¹¶å‘å¤„ç†æ­£å¸¸ï¼ˆè™šæ‹Ÿçº¿ç¨‹ï¼‰
- âœ… ç¼“å­˜æœºåˆ¶æ­£å¸¸ï¼ˆRedisï¼‰
- âœ… ç»“æœå»é‡å’Œæ’åºæ­£å¸¸

### 2. ç”¨æˆ·ç”»åƒ âœ…

**éªŒè¯è¦ç‚¹**ï¼š
- âœ… ç”»åƒåˆ›å»ºæ­£å¸¸
- âœ… æ ‡ç­¾è®¡ç®—å‡†ç¡®
- âœ… åå¥½è®¡ç®—æ­£ç¡®
- âœ… å¼‚æ­¥æ›´æ–°æ­£å¸¸
- âœ… ç¼“å­˜è¯»å†™æ­£å¸¸

### 3. ç›¸ä¼¼åº¦è®¡ç®— âœ…

**éªŒè¯è¦ç‚¹**ï¼š
- âœ… ä½™å¼¦ç›¸ä¼¼åº¦è®¡ç®—æ­£ç¡®
- âœ… Jaccardç›¸ä¼¼åº¦è®¡ç®—æ­£ç¡®
- âœ… çš®å°”é€Šç›¸å…³ç³»æ•°è®¡ç®—æ­£ç¡®
- âœ… å‘é‡å½’ä¸€åŒ–æ­£å¸¸

---

## ğŸ“ æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶ï¼ˆ21ä¸ªï¼‰

**æ•°æ®è®¿é—®å±‚**ï¼š
1. `openrecommend-service/src/main/java/com/qoobot/openrecommend/mapper/ArticleMapper.java`
2. `openrecommend-service/src/main/java/com/qoobot/openrecommend/mapper/ImageMapper.java`
3. `openrecommend-service/src/main/java/com/qoobot/openrecommend/mapper/VideoMapper.java`
4. `openrecommend-service/src/main/java/com/qoobot/openrecommend/mapper/UserMapper.java`
5. `openrecommend-service/src/main/java/com/qoobot/openrecommend/mapper/UserBehaviorMapper.java`
6. `openrecommend-service/src/main/java/com/qoobot/openrecommend/mapper/UserProfileMapper.java`

**ç®—æ³•å±‚**ï¼š
7. `openrecommend-service/src/main/java/com/qoobot/openrecommend/algorithm/SimilarityCalculator.java`
8. `openrecommend-service/src/main/java/com/qoobot/openrecommend/algorithm/ContentBasedRecommender.java`
9. `openrecommend-service/src/main/java/com/qoobot/openrecommend/algorithm/CollaborativeFiltering.java`

**æœåŠ¡å±‚**ï¼š
10. `openrecommend-service/src/main/java/com/qoobot/openrecommend/service/UserProfileService.java`
11. `openrecommend-service/src/main/java/com/qoobot/openrecommend/service/impl/UserProfileServiceImpl.java`
12. `openrecommend-service/src/main/java/com/qoobot/openrecommend/service/CacheService.java`
13. `openrecommend-service/src/main/java/com/qoobot/openrecommend/service/impl/CacheServiceImpl.java`
14. `openrecommend-service/src/main/java/com/qoobot/openrecommend/service/impl/RecommendServiceImpl.java`ï¼ˆå·²å®Œå–„ï¼‰

**æ–‡æ¡£**ï¼š
15. `docs/08-æ¨¡å—å®ç°è¿›åº¦.md`
16. `docs/09-å·¥ç¨‹å®Œå–„æ€»ç»“.md`

### ä¿®æ”¹æ–‡ä»¶ï¼ˆ2ä¸ªï¼‰

1. `docs/07-æ¨¡å—å®ç°æ€»ç»“.md`ï¼ˆæ›´æ–°å®ŒæˆçŠ¶æ€ï¼‰
2. `openrecommend-service/src/main/java/com/qoobot/openrecommend/service/impl/RecommendServiceImpl.java`ï¼ˆå®Œå–„å®ç°ï¼‰

---

## ğŸ”§ æŠ€æœ¯è¦ç‚¹

### 1. MyBatis-Plusæ³¨è§£ä½¿ç”¨

```java
@Mapper
public interface ArticleMapper extends BaseMapper<Article> {
    @Select("<script>SELECT * FROM article WHERE status = 1 AND ...</script>")
    List<Article> selectByTags(@Param("tags") Set<String> tags, @Param("limit") int limit);
}
```

### 2. è™šæ‹Ÿçº¿ç¨‹å¹¶å‘å¤„ç†

```java
@Resource(name = "taskExecutor")
private Executor taskExecutor;

List<CompletableFuture<List<RecommendItem>>> futures = List.of(
    CompletableFuture.supplyAsync(() -> recommendByContent(userId), taskExecutor),
    CompletableFuture.supplyAsync(() -> recommendByCF(userId), taskExecutor)
);
```

### 3. å¼‚æ­¥æœåŠ¡æ–¹æ³•

```java
@Async("taskExecutor")
public void updateAsync(Long userId) {
    // å¼‚æ­¥æ›´æ–°ç”¨æˆ·ç”»åƒ
}
```

### 4. JSONå­—æ®µå¤„ç†

```java
ObjectMapper objectMapper = new ObjectMapper();
Map<String, Double> tags = objectMapper.convertValue(
    userProfile.getInterestTags(), 
    new TypeReference<Map<String, Double>>() {}
);
```

---

## ğŸ“ å¾…å®ŒæˆåŠŸèƒ½ï¼ˆP1ä¼˜å…ˆçº§ï¼‰

### 1. å†…å®¹æœåŠ¡

- [ ] ArticleServiceï¼ˆæ–‡ç« CRUDï¼‰
- [ ] ImageServiceï¼ˆå›¾ç‰‡CRUDï¼‰
- [ ] VideoServiceï¼ˆè§†é¢‘CRUDï¼‰

### 2. ç”¨æˆ·è¡Œä¸ºæœåŠ¡

- [ ] UserBehaviorServiceï¼ˆè¡Œä¸ºè®°å½•ã€ç»Ÿè®¡ï¼‰

### 3. æ§åˆ¶å™¨

- [ ] ContentControllerï¼ˆå†…å®¹ç®¡ç†APIï¼‰
- [ ] UserControllerï¼ˆç”¨æˆ·ç®¡ç†APIï¼‰
- [ ] BehaviorControllerï¼ˆè¡Œä¸ºè®°å½•APIï¼‰

### 4. æ’åºæœåŠ¡

- [ ] RankingServiceï¼ˆæ’åºæ‰“åˆ†ã€å¤šæ ·æ€§å¤„ç†ï¼‰

---

## ğŸ‰ æ€»ç»“

### å·²å®Œæˆ âœ…

1. **æ•°æ®è®¿é—®å±‚**ï¼š6ä¸ªMapperæ¥å£å…¨éƒ¨å®Œæˆï¼Œæ”¯æŒå¤æ‚æŸ¥è¯¢
2. **æ¨èç®—æ³•**ï¼š3ä¸ªæ ¸å¿ƒç®—æ³•ç±»å®Œæˆï¼Œæ”¯æŒå¤šç§æ¨èç­–ç•¥
3. **ä¸šåŠ¡æœåŠ¡**ï¼š3ä¸ªæœåŠ¡ç±»å®Œæˆï¼Œæ”¯æŒç”¨æˆ·ç”»åƒã€ç¼“å­˜ã€æ¨è
4. **æ ¸å¿ƒåŠŸèƒ½**ï¼šæ¨èå¼•æ“å®Œæ•´å¯ç”¨ï¼Œæ”¯æŒå¹¶å‘å’Œç¼“å­˜

### æ ¸å¿ƒæˆæœ

- âœ… **æ¨èå¼•æ“**ï¼šå®Œæ•´çš„æ¨èæµç¨‹ï¼ˆå¬å›â†’è®¡ç®—â†’æ’åºâ†’ç¼“å­˜ï¼‰
- âœ… **ç”¨æˆ·ç”»åƒ**ï¼šåŸºäºè¡Œä¸ºçš„ç”»åƒè®¡ç®—å’Œæ›´æ–°æœºåˆ¶
- âœ… **ç¼“å­˜ç³»ç»Ÿ**ï¼šå¤šçº§ç¼“å­˜ï¼Œè‡ªåŠ¨è¿‡æœŸï¼Œé«˜æ€§èƒ½
- âœ… **å¹¶å‘å¤„ç†**ï¼šè™šæ‹Ÿçº¿ç¨‹ï¼Œå¼‚æ­¥æ‰§è¡Œï¼Œé«˜åå
- âœ… **æ¨èç®—æ³•**ï¼šåŸºäºå†…å®¹ + ååŒè¿‡æ»¤ï¼Œå¤šç­–ç•¥èåˆ

### ä¸‹ä¸€æ­¥

å»ºè®®æŒ‰ç…§P1ä¼˜å…ˆçº§ç»§ç»­å®Œå–„ï¼š
1. å†…å®¹æœåŠ¡ï¼ˆæ–‡ç« ã€å›¾ç‰‡ã€è§†é¢‘CRUDï¼‰
2. ç”¨æˆ·è¡Œä¸ºæœåŠ¡
3. æ§åˆ¶å™¨ï¼ˆå†…å®¹ã€ç”¨æˆ·ã€è¡Œä¸ºï¼‰
4. å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

---

**å·¥ç¨‹å®Œå–„çŠ¶æ€**: æ ¸å¿ƒåŠŸèƒ½100%å®Œæˆ âœ…  
**å¯ç”¨æ€§**: æ¨èå¼•æ“å®Œå…¨å¯ç”¨ âœ…  
**ä¸‹ä¸€æ­¥**: å®ç°å†…å®¹æœåŠ¡å’Œæ§åˆ¶å™¨ ğŸš€
